# MeStore Security Environment Configuration
# ---------------------------------------------------------------------------------------------
# CRITICAL SECURITY NOTICE:
# This file contains examples of secure environment configuration.
# NEVER commit actual secrets to version control.
# Copy this file to .env.production, .env.staging, etc. and set real values.
# ---------------------------------------------------------------------------------------------

# Environment Configuration
ENVIRONMENT=production

# JWT Secret Management - PRODUCTION CRITICAL
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
# MINIMUM 256 bits (32 bytes) for production
JWT_SECRET_KEY=CHANGE_THIS_TO_SECURE_256_BIT_SECRET_IN_PRODUCTION
SECRET_KEY=CHANGE_THIS_TO_SECURE_256_BIT_SECRET_IN_PRODUCTION

# Master Secret for Encryption Key Derivation
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
MASTER_SECRET_KEY=CHANGE_THIS_TO_SECURE_MASTER_SECRET_IN_PRODUCTION

# Encryption Salt for Key Derivation (Base64 encoded)
# Generate with: python -c "import secrets, base64; print(base64.b64encode(secrets.token_bytes(16)).decode())"
ENCRYPTION_SALT=CHANGE_THIS_TO_SECURE_RANDOM_SALT_IN_PRODUCTION

# Database Security
DATABASE_URL=postgresql+asyncpg://secure_user:SECURE_PASSWORD@localhost:5432/mestore_prod
DB_PASSWORD=SECURE_DATABASE_PASSWORD

# Redis Security
REDIS_URL=redis://:SECURE_REDIS_PASSWORD@localhost:6379/0
REDIS_SESSION_URL=redis://:SECURE_REDIS_PASSWORD@localhost:6379/1
REDIS_CACHE_URL=redis://:SECURE_REDIS_PASSWORD@localhost:6379/0

# HashiCorp Vault Configuration (Production)
VAULT_URL=https://vault.company.com:8200
VAULT_TOKEN=SECURE_VAULT_TOKEN
VAULT_MOUNT_POINT=mestore
VAULT_NAMESPACE=production

# AWS Secrets Manager Configuration (Alternative)
AWS_REGION=us-east-1
AWS_SECRET_PREFIX=mestore/production
AWS_ACCESS_KEY_ID=SECURE_AWS_ACCESS_KEY
AWS_SECRET_ACCESS_KEY=SECURE_AWS_SECRET_KEY

# SSL/TLS Configuration
SSL_CERT_PATH=/path/to/ssl/cert.pem
SSL_KEY_PATH=/path/to/ssl/private.key
SSL_CA_BUNDLE_PATH=/path/to/ssl/ca-bundle.crt

# Security Headers and CORS
CORS_ORIGINS=https://app.mestore.com,https://admin.mestore.com
CORS_ALLOW_CREDENTIALS=true

# Rate Limiting Configuration
RATE_LIMIT_ENABLED=true
RATE_LIMIT_AUTHENTICATED_PER_MINUTE=100
RATE_LIMIT_ANONYMOUS_PER_MINUTE=30

# Audit and Logging
LOG_LEVEL=INFO
AUDIT_LOG_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=90
SECURITY_EVENT_LOGGING=true

# Colombian Compliance Configuration
COLOMBIAN_DATA_PROTECTION_ENABLED=true
DIAN_INTEGRATION_ENABLED=true
PERSONAL_DATA_ENCRYPTION_REQUIRED=true

# Payment Security (Wompi)
WOMPI_PUBLIC_KEY=SECURE_WOMPI_PUBLIC_KEY
WOMPI_PRIVATE_KEY=SECURE_WOMPI_PRIVATE_KEY
WOMPI_WEBHOOK_SECRET=SECURE_WOMPI_WEBHOOK_SECRET
WOMPI_ENVIRONMENT=production

# Email Security (SendGrid)
SENDGRID_API_KEY=SECURE_SENDGRID_API_KEY
FROM_EMAIL=noreply@mestore.com

# Two-Factor Authentication
TWILIO_ACCOUNT_SID=SECURE_TWILIO_SID
TWILIO_AUTH_TOKEN=SECURE_TWILIO_TOKEN
TWILIO_VERIFY_SERVICE_SID=SECURE_TWILIO_VERIFY_SID

# Session Security
SESSION_SECURE_COOKIES=true
SESSION_SAME_SITE=strict
SESSION_TIMEOUT_MINUTES=60

# Additional Security Features
SUSPICIOUS_IPS=
ENABLE_IP_BLACKLIST=true
ENABLE_BRUTE_FORCE_PROTECTION=true
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=30

# Monitoring and Alerting
SECURITY_MONITORING_ENABLED=true
ALERT_EMAIL=security@mestore.com
SECURITY_INCIDENT_WEBHOOK=https://monitoring.company.com/webhook

# Backup and Recovery
BACKUP_ENCRYPTION_KEY=SECURE_BACKUP_ENCRYPTION_KEY
BACKUP_RETENTION_DAYS=30

# Development/Testing Override (DO NOT USE IN PRODUCTION)
# TESTING=false
# DEBUG=false